<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Báo cáo BTL2 - Nhóm MLP2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body { background-color: #f4f7f6; font-family: 'Roboto', sans-serif; color: #333; }
        
        /* HEADER STYLE */
        .header-section {
            background: linear-gradient(120deg, #6f42c1, #8e44ad);
            color: white; padding: 4rem 0; margin-bottom: 3rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        /* SECTION TITLES */
        .section-header {
            border-left: 5px solid #6f42c1; padding-left: 15px; margin: 50px 0 25px 0;
            color: #4a148c; font-weight: 800; text-transform: uppercase; letter-spacing: 1px;
        }

        /* CARDS */
        .custom-card {
            border: none; border-radius: 10px; box-shadow: 0 2px 15px rgba(0,0,0,0.05);
            background: #fff; height: 100%; transition: transform 0.3s;
        }
        .custom-card:hover { transform: translateY(-5px); }

        /* PROCESS STEPS */
        .step-item {
            background: #fff; border-radius: 8px; padding: 20px; margin-bottom: 20px;
            border-left: 4px solid #ced4da; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .step-item.active { border-left-color: #6f42c1; background: #fdfbff; }
        .step-icon { font-size: 1.5rem; color: #6f42c1; margin-bottom: 10px; }
        .code-tag { 
            background-color: #eee; color: #d63384; padding: 2px 6px; 
            border-radius: 4px; font-family: monospace; font-size: 0.9em;
        }
        
        /* CHART BOXES */
        .chart-box {
            border: 2px dashed #dee2e6; border-radius: 8px; padding: 10px;
            display: flex; justify-content: center; align-items: center; background: #fff;
            position: relative; overflow: hidden;
        }
        .chart-box img { width: 100%; height: 100%; object-fit: contain; }
        .h-sm { height: 250px; }
        .h-md { height: 350px; }

        /* TABLES */
        .table-custom thead { background-color: #4a148c; color: white; }
        .best-val { color: #198754; font-weight: bold; background-color: #d1e7dd; }
        .bad-val { color: #dc3545; font-weight: bold; background-color: #f8d7da; }

        /* INSIGHT BOX */
        .insight-box {
            background-color: #e8f5e9; border: 1px solid #c8e6c9; border-radius: 8px; padding: 15px;
            color: #2e7d32; font-size: 0.95rem; margin-top: 10px;
        }
    </style>
</head>
<body>

    <header class="header-section text-center">
        <div class="container">
            <h1 class="display-4 fw-bold mb-2">BÁO CÁO HỌC MÁY (BTL2)</h1>
            <p class="fs-4 opacity-90">Phân Loại Văn Bản: Chủ Đề Thơ Ca</p>
            <div class="mt-4">
                <span class="badge bg-warning text-dark px-3 py-2 rounded-pill shadow-sm me-2"><i class="fas fa-users me-2"></i>Nhóm MLP2</span>
                <span class="badge bg-light text-dark px-3 py-2 rounded-pill shadow-sm"><i class="fas fa-check-circle me-2"></i>Best Accuracy: 0.55 (TF-IDF)</span>
            </div>
        </div>
    </header>

    <div class="container pb-5">
        <h2 class="section-header mt-0"><i class="fas fa-database me-2"></i>1. Thông Tin Bộ Dữ Liệu (Dataset Overview)</h2>
        <div class="row mb-5">
            <div class="col-12">
                <div class="custom-card card p-4 shadow-lg">
                    <div class="row">
                        <div class="col-md-5 border-end">
                            <h5 class="fw-bold text-primary mb-3">Tổng quan Dataset</h5>
                            <ul class="list-unstyled">
                                <li class="mb-2"><strong><i class="fas fa-server me-2"></i>Nguồn:</strong> Kaggle (Poetry Foundation)</li>
                                <li class="mb-2"><strong><i class="fas fa-file-alt me-2"></i>Loại dữ liệu:</strong> Văn bản (Text)</li>
                                <li class="mb-2"><strong><i class="fas fa-layer-group me-2"></i>Số lượng mẫu:</strong> > 10,000 bài thơ</li>
                                <li class="mb-2"><strong><i class="fas fa-bullseye me-2"></i>Bài toán:</strong> Phân loại đa lớp (Multi-class Classification)</li>
                            </ul>
                            <div class="alert alert-info small mt-3">
                                Bộ dữ liệu chứa nội dung các bài thơ tiếng Anh được gán nhãn theo chủ đề chính. Nhiệm vụ là dự đoán chủ đề dựa trên nội dung văn bản.
                            </div>
                        </div>
                        <div class="col-md-7 ps-md-4">
                            <h5 class="fw-bold text-primary mb-3">Các nhãn phân loại (Classes)</h5>
                            <p>Dữ liệu được chia thành 5 chủ đề chính:</p>
                            <div class="d-flex flex-wrap">
                                <span class="badge bg-success badge-genre p-2">Nature (Tự nhiên)</span>
                                <span class="badge bg-danger badge-genre p-2">Love (Tình cảm)</span>
                                <span class="badge bg-warning text-dark badge-genre p-2">Religion (Tôn giáo)</span>
                                <span class="badge bg-info text-dark badge-genre p-2">Arts & Sciences (Nghệ thuật & Khoa học)</span>
                                <span class="badge bg-secondary badge-genre p-2">Relationships (Các mối quan hệ)</span>
                            </div>
                            <p class="small text-muted mt-3 fst-italic">
                                *Thách thức: Các chủ đề như "Love" và "Relationships" hoặc "Arts & Sciences" và "Religion" có sự giao thoa lớn về từ vựng, gây khó khăn cho mô hình.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <h2 class="section-header"><i class="fas fa-cogs me-2"></i>2. Quy Trình Xử Lý Dữ Liệu Chi Tiết</h2>
        <div class="row">
            <div class="col-12">
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="step-item active">
                            <div class="step-icon"><i class="fas fa-broom"></i> Bước 1: Làm sạch văn bản (Preprocessing)</div>
                            <p>Hàm <span class="code-tag">clean_text(text)</span> được thiết kế để giảm nhiễu tối đa:</p>
                            <ul class="small text-muted">
                                <li><strong>Lowercase:</strong> <code>text.lower()</code> &rarr; Đồng nhất từ vựng (VD: "Love" và "love" được coi là một).</li>
                                <li><strong>Regex Cleaning:</strong> <code>re.sub(r"[^a-z\s]", "", text)</code> &rarr; Loại bỏ số và ký tự đặc biệt. Trong thơ ca, dấu câu thường mang tính nghệ thuật hơn là ngữ nghĩa phân loại, nên việc loại bỏ giúp mô hình tập trung vào từ khóa.</li>
                                <li><strong>Stopwords Removal:</strong> Loại bỏ các từ hư (the, is, at...) để giảm chiều dữ liệu (vocab size) và tăng trọng số cho các từ mang ý nghĩa nội dung.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="step-item active">
                            <div class="step-icon"><i class="fas fa-project-diagram"></i> Bước 2: Trích xuất đặc trưng (Feature Extraction)</div>
                            <p>Thực nghiệm so sánh 2 cách biểu diễn văn bản:</p>
                            <ul class="small text-muted">
                                <li><strong>TF-IDF (Statistical):</strong> Đánh trọng số dựa trên tần suất. Phương pháp này giả định các bài thơ cùng chủ đề sẽ chia sẻ các "từ khóa" đặc trưng (VD: 'tree', 'flower' cho Nature).</li>
                                <li><strong>BERT Embeddings (Contextual):</strong> Sử dụng <code>bert-base-uncased</code> để chuyển câu thành vector 768 chiều. BERT có khả năng hiểu ngữ cảnh và thứ tự từ, khác với mô hình "túi từ" (Bag of Words).</li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="step-item active">
                            <div class="step-icon"><i class="fas fa-tags"></i> Bước 3: Mã hóa nhãn (Label Encoding)</div>
                            <p>Sử dụng <span class="code-tag">LabelEncoder</span> để chuyển đổi 5 nhãn chủ đề sang dạng số nguyên [0-4].</p>
                            <ul class="small text-muted">
                                <li>Việc này là bắt buộc để tính toán hàm mất mát (Loss Function) như CrossEntropy trong quá trình huấn luyện Neural Network hoặc các mô hình Scikit-learn.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="step-item active">
                            <div class="step-icon"><i class="fas fa-brain"></i> Bước 4: Huấn luyện (Modeling)</div>
                            <p>Chiến lược huấn luyện:</p>
                            <ul class="small text-muted">
                                <li><strong>Classical ML:</strong> Logistic Regression (mạnh về tuyến tính), SVM (tốt cho không gian nhiều chiều), Naive Bayes (cơ bản cho văn bản).</li>
                                <li><strong>Deep Learning (Fine-tuning):</strong> Huấn luyện lại toàn bộ mô hình BERT trên tập dữ liệu thơ (3 epochs, batch_size 16) để mô hình học được văn phong đặc thù của thơ ca.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <h2 class="section-header"><i class="fas fa-chart-bar me-2"></i>3. Phân Tích Dữ Liệu (EDA)</h2>
        <div class="row g-4">
            <div class="col-md-6">
                <div class="custom-card card p-3">
                    <h6 class="fw-bold text-center text-secondary">Phân bố chủ đề (Class Distribution)</h6>
                    <div class="chart-box h-md">
                        <img src="class.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh class.png</span>'">
                    </div>
                    <p class="text-center small text-muted mt-2">Dữ liệu khá cân bằng giữa các lớp (Love, Nature...), ngoại trừ lớp "Relationships" có số lượng thấp nhất, có thể gây khó khăn cho việc học.</p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="custom-card card p-3">
                    <h6 class="fw-bold text-center text-secondary">Đám mây từ (WordCloud)</h6>
                    <div class="chart-box h-md">
                        <img src="wordcloud.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh wordcloud.png</span>'">
                    </div>
                    <p class="text-center small text-muted mt-2">Các từ khóa nổi bật: love, time, night, life, heart... cho thấy sự trùng lặp từ vựng lớn giữa các chủ đề (đặc biệt là Love và Relationships).</p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="custom-card card p-3">
                    <h6 class="fw-bold text-center text-secondary">Tần Suất Từ (Word Frequency)</h6>
                    <div class="chart-box h-md">
                        <img src="word_frequency.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh word_frequency.png</span>'">
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="custom-card card p-3">
                    <h6 class="fw-bold text-center text-secondary">Phân Phối Độ Dài Từ</h6>
                    <div class="chart-box h-md">
                        <img src="word_distribution.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh word_distribution.png</span>'">
                    </div>
                </div>
            </div>
        </div>

        <h2 class="section-header"><i class="fas fa-table me-2"></i>4. Kết Quả: Phương Pháp TF-IDF</h2>
        <div class="row">
            <div class="col-md-8">
                <div class="table-responsive">
                    <table class="table table-custom table-striped table-bordered text-center align-middle">
                        <thead>
                            <tr>
                                <th>Mô hình</th>
                                <th>Precision</th>
                                <th>Recall</th>
                                <th>F1-Score</th>
                                <th>Accuracy</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-success fw-bold">
                                <td>Logistic Regression</td>
                                <td>0.56</td>
                                <td>0.55</td>
                                <td>0.54</td>
                                <td class="best-val">0.55</td>
                            </tr>
                            <tr>
                                <td>SVM</td>
                                <td>0.50</td>
                                <td>0.50</td>
                                <td>0.50</td>
                                <td>0.50</td>
                            </tr>
                            <tr>
                                <td>Naive Bayes</td>
                                <td>0.30</td>
                                <td>0.29</td>
                                <td>0.30</td>
                                <td class="bad-val">0.29</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="insight-box">
                    <strong><i class="fas fa-comment-dots me-2"></i>Phân tích chuyên môn:</strong>
                    TF-IDF kết hợp với Logistic Regression cho kết quả <strong>tốt nhất (0.55)</strong>. Điều này chứng tỏ bài toán phân loại thơ phụ thuộc rất lớn vào các "từ khóa" (keywords) đặc trưng (ví dụ: 'tree', 'sky' cho Nature). Logistic Regression phân tách tốt các không gian dữ liệu này. Naive Bayes (Gaussian) thất bại do dữ liệu TF-IDF quá thưa.
                </div>
            </div>
            <div class="col-md-4">
                <div class="custom-card card p-2">
                    <p class="text-center small fw-bold mb-1">Confusion Matrix: TF-IDF + Logistic</p>
                    <div class="chart-box h-sm">
                        <img src="tfidflogisticregesssion.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh tfidflogisticregesssion.png</span>'">
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4 g-3">
            <div class="col-md-6">
                <div class="custom-card card p-2">
                    <p class="text-center small fw-bold mb-1">Confusion Matrix: TF-IDF + SVM</p>
                    <div class="chart-box h-sm">
                        <img src="tfidfsvm.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh tfidfsvm.png</span>'">
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="custom-card card p-2">
                    <p class="text-center small fw-bold mb-1">Confusion Matrix: TF-IDF + Naive Bayes</p>
                    <div class="chart-box h-sm">
                        <img src="tfidfnaivebayas.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh tfidfnaivebayas.png</span>'">
                    </div>
                </div>
            </div>
        </div>

        <h2 class="section-header"><i class="fas fa-table me-2"></i>5. Kết Quả: BERT Feature Extraction</h2>
        <div class="row">
            <div class="col-md-8">
                <div class="table-responsive">
                    <table class="table table-custom table-striped table-bordered text-center align-middle">
                        <thead>
                            <tr>
                                <th>Mô hình</th>
                                <th>Precision</th>
                                <th>Recall</th>
                                <th>F1-Score</th>
                                <th>Accuracy</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Logistic Regression</td>
                                <td>0.51</td>
                                <td>0.51</td>
                                <td>0.51</td>
                                <td>0.51</td>
                            </tr>
                            <tr>
                                <td>SVM</td>
                                <td>0.50</td>
                                <td>0.50</td>
                                <td>0.50</td>
                                <td>0.50</td>
                            </tr>
                            <tr>
                                <td>Naive Bayes</td>
                                <td>0.40</td>
                                <td>0.39</td>
                                <td>0.38</td>
                                <td>0.39</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="insight-box" style="background-color: #fff3cd; border-color: #ffecb5; color: #856404;">
                    <strong><i class="fas fa-exclamation-triangle me-2"></i>Tại sao thấp hơn TF-IDF?</strong>
                    Việc sử dụng BERT pre-trained chỉ để trích xuất đặc trưng mà không Fine-tune cho kết quả kém hơn. Vector ngữ cảnh của BERT tổng quát chưa tối ưu cho ngôn ngữ thơ ca trừu tượng, trong khi TF-IDF bắt trực tiếp vào tần suất từ khóa nên hiệu quả hơn ở bài toán này.
                </div>
            </div>
            <div class="col-md-4">
                <div class="custom-card card p-2">
                    <p class="text-center small fw-bold mb-1">Confusion Matrix: BERT + Logistic</p>
                    <div class="chart-box h-sm">
                        <img src="bertlogisticregression.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh bertlogisticregression.png</span>'">
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4 g-3">
            <div class="col-md-6">
                <div class="custom-card card p-2">
                    <p class="text-center small fw-bold mb-1">Confusion Matrix: BERT + SVM</p>
                    <div class="chart-box h-sm">
                        <img src="bertsvm.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh bertsvm.png</span>'">
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="custom-card card p-2">
                    <p class="text-center small fw-bold mb-1">Confusion Matrix: BERT + Naive Bayes</p>
                    <div class="chart-box h-sm">
                        <img src="bertnaivebayse.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh bertnaivebayse.png</span>'">
                    </div>
                </div>
            </div>
        </div>

        <h2 class="section-header"><i class="fas fa-microchip me-2"></i>6. Deep Learning: Fine-tuned BERT</h2>
        <div class="row">
            <div class="col-md-7">
                <div class="custom-card card p-4 shadow-sm border-warning" style="border-width: 2px;">
                    <h4 class="text-warning fw-bold mb-3">Kết quả chi tiết Fine-tuning</h4>
                    <table class="table table-sm text-center table-bordered">
                        <thead class="table-light"><tr><th>Class</th><th>Precision</th><th>Recall</th><th>F1-Score</th></tr></thead>
                        <tbody>
                            <tr><td>Arts & Sciences</td><td>0.59</td><td>0.35</td><td>0.44</td></tr>
                            <tr><td>Love</td><td>0.63</td><td>0.43</td><td>0.51</td></tr>
                            <tr><td>Nature</td><td>0.57</td><td>0.61</td><td>0.59</td></tr>
                            <tr class="table-danger fw-bold">
                                <td>Relationships</td>
                                <td>0.33</td>
                                <td class="text-danger">0.73 (Cao nhất)</td>
                                <td>0.46</td>
                            </tr>
                            <tr><td>Religion</td><td>0.70</td><td>0.40</td><td>0.51</td></tr>
                            <tr class="table-dark"><td>Accuracy</td><td colspan="3">0.50</td></tr>
                        </tbody>
                    </table>
                    
                    <div class="analysis-box">
                        <strong><i class="fas fa-star me-2"></i></strong>
                        Mặc dù Accuracy tổng thể (0.50) không cao hơn Logistic Regression (0.55), nhưng BERT Fine-tuned đạt <strong>Recall cực cao (0.73) cho lớp "Relationships"</strong>.
                        <br><br>
                        <em>Giải thích:</em> Lớp "Relationships" chứa nhiều ẩn dụ về mối quan hệ (gia đình, bạn bè) mà không có từ khóa cố định như Nature. TF-IDF thất bại ở đây (Recall ~0.43), nhưng cơ chế <strong>Attention</strong> của BERT giúp mô hình "hiểu" được ngữ cảnh sâu xa này.
                    </div>
                </div>
            </div>
            
            <div class="col-md-5">
                <div class="custom-card card p-3">
                    <h6 class="text-center fw-bold text-warning">Confusion Matrix: BERT Fine-tuned</h6>
                    <div class="chart-box h-md">
                        <img src="finetunebert.png" onerror="this.parentElement.innerHTML='<span class=\'text-danger\'>Thiếu ảnh finetunebert.png</span>'">
                    </div>
                </div>
            </div>
        </div>

        <h2 class="section-header"><i class="fas fa-clipboard-check me-2"></i>7. Tổng Hợp</h2>
        <div class="row">
            <div class="col-12">
                <div class="custom-card card p-0">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover text-center align-middle mb-0">
                            <thead class="table-dark">
                                <tr>
                                    <th class="py-3">Phương Pháp</th>
                                    <th>Mô Hình</th>
                                    <th>Accuracy</th>
                                    <th>Đánh giá Chuyên Môn</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="table-success fw-bold">
                                    <td>TF-IDF</td>
                                    <td>Logistic Regression</td>
                                    <td>0.55</td>
                                    <td class="text-start ps-4">Mô hình tốt nhất về tổng thể. Đơn giản, hiệu quả với dữ liệu văn bản nhỏ và đặc trưng từ khóa rõ ràng.</td>
                                </tr>
                                <tr>
                                    <td>BERT (Fine-tune)</td>
                                    <td>BERT Base</td>
                                    <td>0.50</td>
                                    <td class="text-start ps-4">Khả năng hiểu ngữ nghĩa sâu sắc nhất. Rất tốt cho các lớp khó như "Relationships".</td>
                                </tr>
                                <tr>
                                    <td>TF-IDF</td>
                                    <td>SVM</td>
                                    <td>0.50</td>
                                    <td class="text-start ps-4">Hiệu quả ở mức khá, tương đương BERT nhưng chi phí tính toán thấp hơn.</td>
                                </tr>
                                <tr>
                                    <td>TF-IDF</td>
                                    <td>Naive Bayes</td>
                                    <td>0.29</td>
                                    <td class="text-start ps-4 text-danger">Không phù hợp với phân phối dữ liệu thưa của TF-IDF.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="alert alert-info mt-4">
                    <strong><i class="fas fa-info-circle me-2"></i>Kết luận:</strong> 
                    Kết quả cho thấy các mô hình thống kê đơn giản (Logistic Regression) vẫn rất mạnh mẽ với dữ liệu văn bản có quy mô vừa phải và chủ đề rõ ràng. Tuy nhiên, Deep Learning (BERT) mở ra khả năng hiểu ngữ nghĩa sâu sắc hơn cho các lớp dữ liệu khó và trừu tượng.
                </div>
            </div>
        </div>

    </div>

    <footer class="text-center py-4 mt-5 bg-white border-top text-muted">
        <small>&copy; 2024 Nhóm MLP2 - Báo cáo môn Học Máy (CO3117)</small>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>